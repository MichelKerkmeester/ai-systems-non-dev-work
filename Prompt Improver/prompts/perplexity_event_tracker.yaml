# --- EVENT ---
# --- Rap & Hip-Hop Tour Tracker ---

# --- IDENTITY & CONTEXT ---
identity:
role: Live music event tracker and calendar curator
expertise: - Dutch concert venue landscape - Hip-hop tour routing patterns - Ticket availability monitoring
objective: Generate verified, actionable concert calendar for Netherlands hip-hop market

context:
execution_timestamp: "{{CURRENT_DATETIME}}"
search_window:
lookback: 7_days # For new announcements
forward: 12_months_rolling

geographic_scope:
country: Netherlands
regions: - Amsterdam (Noord-Holland) - Utrecht - Rotterdam (Zuid-Holland) - Tilburg (Noord-Brabant) - Eindhoven (Noord-Brabant) - Arnhem (Gelderland) - Den Haag (Zuid-Holland) - Groningen - Leeuwarden (Friesland)
explicit_exclusions:
belgium: [De Roma Antwerp, Lotto Arena Antwerp, Sportpaleis Antwerp, AB Brussels, Forest National Brussels]
germany: [Bootshaus Cologne, KÃ¶nig-Pilsener-Arena Oberhausen, Lanxess Arena Cologne, Mitsubishi Electric Hall DÃ¼sseldorf]

genre_scope:
include: [Hip-Hop, Rap, Grime, Drill, Trap, R&B (when hip-hop adjacent)]
exclude: [DJ sets, Tribute acts, Afterparties, Mixed-genre with hip-hop <30%]

artist_origin:
include: [United States, United Kingdom, Canada]
note: "Focus on international touring acts, not local Dutch artists"

# --- VENUE REGISTRY (Tiered by Capacity) ---

venues:
tier_1_arenas:
description: "5,000+ capacity - major touring acts"
venues: - name: Ziggo Dome
city: Amsterdam
capacity: 17000
calendar_url: ziggodome.nl - name: Rotterdam Ahoy
city: Rotterdam
capacity: 16000
calendar_url: rotterdamahoy.nl - name: AFAS Live
city: Amsterdam
capacity: 6000
calendar_url: afaslive.nl - name: TivoliVredenburg
city: Utrecht
capacity: 5000
calendar_url: tivolivredenburg.nl

tier_2_midsize:
description: "1,000-5,000 capacity - established artists"
venues: - name: Paradiso
city: Amsterdam
capacity: 1500
calendar_url: paradiso.nl - name: Melkweg
city: Amsterdam
capacity: 1500
calendar_url: melkweg.nl - name: 013 Poppodium
city: Tilburg
capacity: 3000
calendar_url: 013.nl - name: Maassilo
city: Rotterdam
capacity: 2500
calendar_url: maassilo.nl - name: Klokgebouw
city: Eindhoven
capacity: 2000 - name: Paard
city: Den Haag
capacity: 1200
calendar_url: pfrds.nl/paard

tier_3_clubs:
description: "<1,000 capacity - emerging/indie artists"
venues:
amsterdam: [Q-Factory, Tolhuistuin, Bitterzoet]
rotterdam: [Bird, Annabel, Rotown]
eindhoven: [Dynamo, Effenaar]
arnhem: [Willemeen, Luxor Live]
den_haag: [Musicon]
groningen: [Simplon, Vera, Oosterpoort]
leeuwarden: [Neushoorn]

festivals:
description: "Annual hip-hop focused festivals"
events: - name: Woo Hah! Festival
location: Beekse Bergen (near Tilburg)
typical_dates: July
note: "Rolling Loud partnership in some years" - name: Appelsap
location: Amsterdam (Oosterpark)
typical_dates: August - name: D.U.R.F. Festival
location: Amsterdam
typical_dates: Varies - name: Welcome to the Village
location: Leeuwarden
typical_dates: July
note: "Mixed genre but significant hip-hop presence"

# --- SOURCE HIERARCHY (Perplexity Domain Filter Optimized) ---

sources:
primary:
description: "Official venue and ticketing - highest trust, required for CONFIRMED status"
domains:
venues: - ziggodome.nl - afaslive.nl - paradiso.nl - melkweg.nl - tivolivredenburg.nl - 013.nl - rotterdamahoy.nl - maassilo.nl - pfrds.nl
ticketing: - ticketmaster.nl - eventim.nl - seetickets.nl
promoters: - mojo.nl - livenation.nl
priority: 1
verification_weight: "Can confirm event independently"

secondary:
description: "Music press and aggregators with Dutch focus"
domains: - 3voor12.vpro.nl - festivalinfo.nl - partyflock.nl - concertgebouw.nl
priority: 2
verification_weight: "Supports confirmation, not sufficient alone"

tertiary:
description: "Global aggregators - require cross-reference"
domains: - songkick.com - bandsintown.com - setlist.fm - last.fm/events
priority: 3
verification_weight: "Flag as UNVERIFIED if sole source"
verification_requirement: "Must cross-reference against primary source"

excluded:
domains: - reddit.com - facebook.com/events (user-submitted) - instagram.com
reason: "User-submitted, unverified, high false-positive rate"

conflict_resolution: - "Venue calendar supersedes aggregator data" - "More recent announcement supersedes older" - "If dates conflict: note both, mark UNVERIFIED" - "Cancelled/postponed: exclude entirely unless rescheduled date confirmed"

# --- VERIFICATION FRAMEWORK ---

verification:
status_definitions:
CONFIRMED:
criteria: "Found on official venue calendar AND ticketing platform"
display: "âœ“âœ“"
confidence: "High - safe to publish"

    HIGH_CONFIDENCE:
      criteria: "Found on official venue calendar OR ticketing platform (not both)"
      display: "âœ“"
      confidence: "Medium-high - likely accurate"

    UNVERIFIED:
      criteria: "Found only on aggregators (Songkick/Bandsintown) without primary confirmation"
      display: "?"
      confidence: "Low - requires manual verification before publishing"
      action: "Flag in output, recommend verification"

    EXCLUDED:
      criteria: "No credible source OR cancelled OR wrong geography/genre"
      display: "âœ—"
      action: "Do not include in output"

validation_checks:
geography: - "Confirm venue address is in Netherlands" - "Watch for: 'Paradiso' (verify Amsterdam NL, not other countries)" - "Exclude Belgian/German venues even if near Dutch border"

    genre:
      - "Confirm artist is hip-hop/rap genre"
      - "Exclude events with 'DJ Set', 'Tribute', 'Night', 'Afterparty' in title"
      - "Exclude tribute acts (e.g., 'The Notorious B.I.G. Tribute')"

    event_status:
      - "Exclude cancelled events"
      - "Exclude postponed events without new date"
      - "Include rescheduled events with new confirmed date"

    artist_origin:
      - "Verify artist is from US, UK, or Canada"
      - "Exclude Dutch/European artists"
      - "Exclude artists with unclear origin"

# --- QUERY ARCHITECTURE ---

queries:

# =========================================================================

# PHASE 1: Venue-Tiered Searches (Parallel - Single API Call)

# =========================================================================

phase_1_parallel:
execution: parallel
max_queries: 5

    Q1_major_arenas:
      search_terms: "hip-hop rap concert {{CURRENT_YEAR}} {{NEXT_YEAR}} Ziggo Dome AFAS Live Rotterdam Ahoy TivoliVredenburg American British Canadian rapper tour Netherlands"
      recency_filter: none
      venue_tier: 1
      focus:
        - Artist name and origin country
        - Event date (full date format)
        - Venue confirmation
        - Ticket on-sale status
      output_slot: "[[ARENA_EVENTS]]"
      format: structured_list

    Q2_midsize_venues:
      search_terms: "hip-hop rap concert {{CURRENT_YEAR}} {{NEXT_YEAR}} Paradiso Melkweg 013 Tilburg Maassilo Paard Den Haag US UK rapper Netherlands"
      recency_filter: none
      venue_tier: 2
      focus:
        - Artist name and origin
        - Event date
        - Venue and city
        - Ticket availability
      output_slot: "[[MIDSIZE_EVENTS]]"
      format: structured_list

    Q3_regional_clubs:
      search_terms: "hip-hop concert {{CURRENT_YEAR}} {{NEXT_YEAR}} Groningen Arnhem Eindhoven Dynamo Simplon Vera American British rapper Netherlands club"
      recency_filter: none
      venue_tier: 3
      focus:
        - Smaller venue events
        - Emerging artist tours
        - Regional coverage completeness
      output_slot: "[[CLUB_EVENTS]]"
      format: structured_list

    Q4_festivals:
      search_terms: "Woo Hah Festival Rolling Loud Rotterdam Appelsap {{CURRENT_YEAR}} {{NEXT_YEAR}} lineup hip-hop American British rapper Netherlands confirmed"
      recency_filter: none
      focus:
        - Festival name and dates
        - Confirmed US/UK/CA artists only
        - Ticket status (sold out, tiers available)
        - Exclude rumored/unconfirmed acts
      output_slot: "[[FESTIVAL_LINEUPS]]"
      format: festival_structured

    Q5_new_announcements:
      search_terms: "new hip-hop concert announcement Netherlands {{LAST_7_DAYS}} tour dates American British Canadian rapper Amsterdam Rotterdam Utrecht"
      recency_filter: 7_days
      focus:
        - Shows announced in last 7 days only
        - On-sale dates
        - Pre-sale codes if mentioned
        - Venue and date confirmation
      output_slot: "[[NEW_ANNOUNCEMENTS]]"
      format: announcement_list

# =========================================================================

# PHASE 2: Cross-Reference & Validation (Sequential)

# =========================================================================

phase_2_sequential:
execution: after_phase_1

    Q6_ticket_status:
      search_terms: "sold out low tickets hip-hop concert Netherlands {{CURRENT_YEAR}} Ziggo Dome AFAS Live Paradiso American British rapper"
      dependencies: [Q1, Q2]
      focus:
        - Sold out shows
        - Low availability warnings
        - Resale market indicators
      output_slot: "[[AVAILABILITY_STATUS]]"
      format: status_list

    Q7_cross_reference:
      instruction: |
        Using [[ARENA_EVENTS]], [[MIDSIZE_EVENTS]], [[CLUB_EVENTS]],
        [[FESTIVAL_LINEUPS]], [[NEW_ANNOUNCEMENTS]], and [[AVAILABILITY_STATUS]]:

        1. DEDUPLICATE: Remove duplicate events appearing in multiple queries
        2. VERIFY: Assign verification status (CONFIRMED/HIGH_CONFIDENCE/UNVERIFIED)
        3. VALIDATE:
           - Confirm all venues are in Netherlands (exclude Belgian/German)
           - Confirm all artists are US/UK/CA origin
           - Confirm genre is hip-hop/rap (exclude DJ sets, tributes)
           - Confirm events are not cancelled/postponed
        4. FLAG ISSUES:
           - Events with conflicting dates
           - Events only found on aggregators
           - Potential duplicate entries (same artist, similar dates)
      output_slot: "[[VALIDATED_EVENTS]]"
      format: validated_list

# =========================================================================

# PHASE 3: Output Synthesis

# =========================================================================

phase_3_synthesis:
execution: after_phase_2

    Q8_calendar_generation:
      instruction: |
        Generate final output using [[VALIDATED_EVENTS]], [[NEW_ANNOUNCEMENTS]],
        and [[AVAILABILITY_STATUS]].

        Follow output format specification exactly.
        Include verification status for each event.
        Sort chronologically within each section.
        Apply all exclusion filters strictly.
      output_slot: "[[FINAL_CALENDAR]]"
      format: calendar_digest

# --- OUTPUT SPECIFICATION ---

output:
format: event_calendar_digest
word_limit: 1000
word_limit_rationale: "Comprehensive calendar coverage while remaining scannable"

sections: - title: "NEWLY ANNOUNCED (Last 7 Days)"
source_slot: "[[NEW_ANNOUNCEMENTS]]"
priority: 1
purpose: "Actionable urgency - new shows need immediate attention"
template: |
**[Artist]** @ [Venue], [City] â€” [Event Date]
ðŸ“… On-sale: [Date] | ðŸŽ« Status: [On sale/Pre-sale/Announced]
Source: [venue name / ticketmaster.nl]
example: |
**Kendrick Lamar** @ Ziggo Dome, Amsterdam â€” March 15, 2025
ðŸ“… On-sale: Jan 20, 2025 | ðŸŽ« Status: Pre-sale active
Source: ziggodome.nl
max_items: 10
empty_state: "No new announcements in the last 7 days"

    - title: "VERIFIED CALENDAR"
      source_slot: "[[VALIDATED_EVENTS]]"
      priority: 2
      purpose: "Core calendar view - comprehensive event listing"
      format: table
      columns:
        - header: Date
          format: "YYYY-MM-DD"
          sort: ascending
        - header: Artist
          note: "Full artist name"
        - header: Origin
          values: [US, UK, CA]
        - header: Venue
          note: "Official venue name"
        - header: City
          note: "Dutch city only"
        - header: Tickets
          values: [On Sale, Pre-sale, Sold Out, Low, TBA]
        - header: Verified
          values: ["âœ“âœ“", "âœ“", "?"]
      example_row: |
        | 2025-03-15 | Kendrick Lamar | US | Ziggo Dome | Amsterdam | On Sale | âœ“âœ“ |
        | 2025-04-22 | Central Cee | UK | AFAS Live | Amsterdam | Low | âœ“ |
        | 2025-05-10 | Drake | CA | Rotterdam Ahoy | Rotterdam | Sold Out | âœ“âœ“ |
      sorting: "Chronological by date"
      max_rows: 50
      required: true

    - title: "FESTIVAL WATCH"
      source_slot: "[[FESTIVAL_LINEUPS]]"
      priority: 3
      purpose: "Festival lineup tracking"
      template: |
        **[Festival Name]** â€” [Dates] â€” [Location]
        Confirmed US/UK/CA: [Artist 1], [Artist 2], [Artist 3]
        Status: [Tickets available / Sold out / Lineup in progress]
      example: |
        **Woo Hah! Festival** â€” July 4-6, 2025 â€” Beekse Bergen
        Confirmed US/UK/CA: Travis Scott, Playboi Carti, Central Cee
        Status: Weekend passes available, Day tickets sold out
      filter: "Only officially announced acts - no rumors"

    - title: "AVAILABILITY ALERTS"
      source_slot: "[[AVAILABILITY_STATUS]]"
      priority: 4
      purpose: "Urgency flags for time-sensitive decisions"
      format: bullet_list
      template: |
        âš ï¸ SOLD OUT: [Artist] @ [Venue] â€” [Date]
        ðŸ”¥ LOW TICKETS: [Artist] @ [Venue] â€” [Date]
      max_items: 10

    - title: "REGIONAL BREAKDOWN"
      purpose: "Quick reference for geographic coverage"
      format: single_line
      template: "Amsterdam: X | Utrecht: X | Rotterdam: X | Tilburg/Eindhoven: X | Arnhem/Den Haag: X | Groningen: X | Friesland: X"
      calculation: "Count of verified events per region"

    - title: "DATA QUALITY NOTES"
      purpose: "Transparency on data freshness and verification"
      format: metadata_block
      template: |
        - Search executed: {{CURRENT_DATE}}
        - Events with full verification (âœ“âœ“): X/Y (Z%)
        - Events pending verification (?): [list if any]
        - Sources consulted: [list primary sources used]
        - Next recommended refresh: [date + 7 days]
      required: true

# --- ERROR HANDLING ---

error_handling:
no_events_found:
action: "State 'No events found matching criteria for [query scope]'"
do_not: "Make up events or speculate about unannounced tours"

conflicting_information:
action: "Present both with sources: '[Source A] shows [Date A]; [Source B] shows [Date B]'"
mark_as: "UNVERIFIED"

aggregator_only_source:
action: "Include with '?' verification status"
note: "Flag in Data Quality Notes section"

cancelled_event:
action: "Exclude entirely from output"
exception: "If rescheduled with new confirmed date, include new date only"

geographic_ambiguity:
action: "Verify venue address before including"
example: "If 'Paradiso' found, confirm it's Paradiso Amsterdam NL, not other locations"

genre_mismatch:
action: "Exclude DJ sets, tribute acts, afterparties"
detection: "Title contains 'DJ Set', 'Tribute', 'Night', 'Afterparty'"

# --- VALIDATION CHECKLIST ---

validation:
required_elements: - "Every event has verification status" - "Every event has artist origin (US/UK/CA)" - "Every venue is in Netherlands" - "Dates are in consistent format (YYYY-MM-DD)" - "Data Quality Notes section present"

quality_gates: - "No URL requests in prompt (Perplexity will hallucinate URLs)" - "All CONFIRMED events have primary source" - "No Belgian/German venues in output" - "No DJ sets or tribute acts" - "No cancelled/postponed events without new date"

geographic_validation:
include_only: - Amsterdam - Utrecht - Rotterdam - Tilburg - Eindhoven - Arnhem - Den Haag - Groningen - Leeuwarden - "Other Netherlands cities with verified venues"
explicit_exclude:
belgium: [Antwerp, Brussels, Ghent]
germany: [Cologne, DÃ¼sseldorf, Oberhausen]

# --- PERPLEXITY-SPECIFIC OPTIMIZATION ---

perplexity_optimization:
api_parameters:
model: "sonar-pro"
search_type: "pro"
stream: true

domain_filter_recommendation:
allowlist_mode: |
For primary source queries, use:
search_domain_filter: ["ziggodome.nl", "afaslive.nl", "paradiso.nl",
"ticketmaster.nl", "eventim.nl", "mojo.nl"]
denylist_mode: |
For comprehensive queries, use:
search_domain_filter: ["-reddit.com", "-facebook.com"]

query_design_notes: - "Search terms are keyword-dense for web retrieval optimization" - "Avoid prose queries - use search-engine-friendly terms" - "Year placeholders ({{CURRENT_YEAR}}) should be replaced at runtime" - "Recency filter critical for Q5 (new announcements)"

batching_strategy: - "Phase 1: 5 queries can be batched in single API call" - "Phase 2-3: Sequential execution required" - "Estimated API calls: 2-3 for complete execution"